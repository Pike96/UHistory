var DayCalendarView=function(t,e){function a(t){u=[Math.round(.2*t),Math.round(.4*t),Math.round(.6*t),Math.round(.8*t)],p.empty();(e=$("<div id='colorLegendValueMin'>")).html("<"+u[0]),p.append(e);var e;(e=$("<div id='colorLegendValueMax'>")).html(u[3]+"<"),p.append(e)}var n=new CalHeatMap,r=$("<div id='dayCalContainer'>"),o=$("<h2>");o.html("Month / Hour View"),t.append(o);var d=$("<button class='nextButton glyphicon glyphicon-chevron-right'>"),h=$("<button class='previousButton glyphicon glyphicon-chevron-left'>");t.append(d,h);var l=$("<ul id='hourLegend'>");for(i=0;i<24;i++){var g=$("<li>"),s=$("<div style='text-align: right'>");s.html(i),g.append(s),l.append(g)}var u=new Array,p=$("<div id='colorLegendValuesContainer'>");stDate=new Date(Date.now()),stDate.setMonth(stDate.getMonth()-1),this.nextButton=d,this.previousButton=h,this.cal=n,e.addObserver(this),this.update=function(o){if("dataReady"==o)t.append(l),t.append(p),t.append(r),function(t){var r=e.getHourlyMax();n.init({data:t,itemSelector:"#dayCalContainer",domain:"month",subDomain:"hour",cellSize:10,cellPadding:2,tooltip:!0,displayLegend:!1,itemName:"site",domainGutter:5,rowLimit:24,range:2,start:stDate,displayLegend:!0,legendVerticalPosition:"top",legendHorizontalPosition:"left",legendCellSize:27,legendMargin:[-7,0,12,592],legend:[Math.round(.2*r),Math.round(.4*r),Math.round(.6*r),Math.round(.8*r)],onClick:function(t,a,n){$("#daycal svg.graph rect").css("stroke","none"),$("#daycal svg.graph rect").attr("height",10).attr("width",10),$("#cal svg.graph rect").attr("height",30).attr("width",30),$("#weekcal svg.graph rect").attr("height",27).attr("width",27),$(n).css("stroke","rgba(0,255,0,1)"),$(n).attr("height",9).attr("width",9);var r=e.hours.filter(function(e){if(e[0].getMonth()==t.getMonth()&&e[0].getDate()==t.getDate()&&e[0].getHours()==t.getHours())return e});r.length>0&&e.setSelectedItem(r[0])}}),a(r)}(e.toJSON(e.hours));else if("dayCalendar"==e.getCurrentView()){var i=e.toJSON(e.getHoursSearch());n.update(i),n.options.data=i;var d=e.getHoursSearchMax();n.setLegend([Math.round(.2*d),Math.round(.4*d),Math.round(.6*d),Math.round(.8*d)]),a(d)}}};