var MonthCalendarView=function(t,e){function a(t){u=[Math.round(.2*t),Math.round(.4*t),Math.round(.6*t),Math.round(.8*t)],c.empty();(e=$("<div id='colorLegendValueMin'>")).html("<"+u[0]),c.append(e);var e;(e=$("<div id='colorLegendValueMax'>")).html(u[3]+"<"),c.append(e)}var n=new CalHeatMap,r=$("<div id='monthCalContainer'>"),o=$("<h2>");o.html("Month / Day View"),t.append(o);var d=$("<button class='nextButton glyphicon glyphicon-chevron-right'>"),h=$("<button class='previousButton glyphicon glyphicon-chevron-left'>");t.append(d,h);var l=$("<ul id='dayLegend'>"),g=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];for(i=0;i<g.length;i++){var s=$("<li>");s.html(g[i]),l.append(s)}startDate=new Date(Date.now()),startDate.setMonth(startDate.getMonth()-3);var u=new Array,c=$("<div id='colorLegendValuesContainer'>");this.nextButton=d,this.previousButton=h,this.cal=n,e.addObserver(this),this.update=function(i){if("dataReady"==i)t.append(l),t.append(c),t.append(r),function(t){var r=e.getDailyMax();n.init({data:t,itemSelector:"#monthCalContainer",domain:"month",subDomain:"day",itemName:"site",range:5,cellSize:30,cellPadding:2,domainMargin:[0,6,0,0],tooltip:!0,highlight:"now",label:{offset:{x:0,y:-15}},start:startDate,displayLegend:!0,legend:[Math.round(.2*r),Math.round(.4*r),Math.round(.6*r),Math.round(.8*r)],legendVerticalPosition:"top",legendHorizontalPosition:"left",legendCellSize:30,legendMargin:[-10,0,12,568],onClick:function(t,a,n){$("#cal svg.graph rect").css("stroke","none"),$("#cal svg.graph rect").attr("height",30).attr("width",30),$("#daycal svg.graph rect").attr("height",10).attr("width",10),$("#weekcal svg.graph rect").attr("height",27).attr("width",27),$(n).css("stroke","rgba(0,255,0,1)"),$(n).attr("height",29).attr("width",29);var r=e.days.filter(function(e){if(e[0].getMonth()==t.getMonth()&&e[0].getDate()==t.getDate())return e});r.length>0&&e.setSelectedItem(r[0])}}),a(r)}(e.toJSON(e.days));else if("monthCalendar"==e.getCurrentView()){var o=e.toJSON(e.getDaysSearch());n.update(o),n.options.data=o;var d=e.getDaysSearchMax();n.setLegend([Math.round(.2*d),Math.round(.4*d),Math.round(.6*d),Math.round(.8*d)]),a(d)}}};